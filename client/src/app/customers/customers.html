<section class="space-y-4">
	<div class="rounded-2xl border border-neutral-800 bg-neutral-900">
		<div class="flex flex-wrap items-center justify-between gap-3 p-4">
			<div class="flex flex-1 flex-wrap items-center gap-3">
				<div class="relative w-full max-w-sm">
					<span class="pointer-events-none absolute inset-y-0 left-3 flex items-center text-gray-500">
						<svg
							viewBox="0 0 24 24"
							fill="none"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
							class="h-5 w-5"
						>
							<path
								d="M21 21L16.7 16.7"
								stroke="currentColor"
								stroke-width="1.5"
								stroke-linecap="round"
							/>
							<path
								d="M11 18C14.866 18 18 14.866 18 11C18 7.13401 14.866 4 11 4C7.13401 4 4 7.13401 4 11C4 14.866 7.13401 18 11 18Z"
								stroke="currentColor"
								stroke-width="1.5"
							/>
						</svg>
					</span>
					<input
						type="search"
						placeholder="Search"
						[(ngModel)]="searchTerm"
						(ngModelChange)="onSearchTermChange()"
						class="w-full rounded-xl border border-neutral-800 bg-neutral-950 py-2.5 pl-10 pr-3 text-sm text-gray-100 placeholder:text-gray-500 outline-none focus-visible:ring-2 focus-visible:ring-orange-500"
					/>
				</div>

				<button
					type="button"
					(click)="exportVisibleToCsv()"
					class="inline-flex items-center gap-2 rounded-xl border border-neutral-800 bg-neutral-950 px-4 py-2.5 text-sm text-gray-200 transition-colors hover:bg-neutral-900 focus-visible:ring-2 focus-visible:ring-orange-500 outline-none"
				>
					<span>Export</span>
					<span class="text-gray-500">+</span>
				</button>
			</div>

			<div class="flex items-center gap-2 text-sm text-gray-400">
				<span>Sort by :</span>
				<select
					[(ngModel)]="sortOrder"
					(ngModelChange)="onSortOrderChange()"
					aria-label="Sort customers"
					class="rounded-xl border border-neutral-800 bg-neutral-950 px-3 py-2 text-sm text-gray-200 outline-none focus-visible:ring-2 focus-visible:ring-orange-500"
				>
					<option value="newest">newest</option>
					<option value="oldest">oldest</option>
				</select>
			</div>
		</div>

		<div class="overflow-x-auto">
			<table class="min-w-full border-separate border-spacing-0 text-left text-sm">
				<thead>
					<tr class="text-xs text-gray-400">
						<th class="sticky left-0 z-10 bg-neutral-900 px-4 py-3">
							<input
								type="checkbox"
								[checked]="isAllVisibleSelected()"
								(change)="toggleAllVisible($any($event.target).checked)"
								class="h-4 w-4 rounded border-neutral-700 bg-neutral-950"
							/>
						</th>
						<th class="px-2 py-3">Avatar</th>
						<th class="px-4 py-3">Client name</th>
						<th class="px-4 py-3">Phone number</th>
						<th class="px-4 py-3">Email</th>
						<th class="px-4 py-3">Address</th>
						<th class="px-4 py-3">Total Payments</th>
						<th class="px-4 py-3 text-right">Actions</th>
					</tr>
				</thead>

				<tbody>
					<tr
						*ngFor="let customer of visibleCustomers; trackBy: trackById"
						class="border-t border-neutral-800 text-gray-100"
					>
						<td class="sticky left-0 z-10 bg-neutral-900 px-4 py-3">
							<input
								type="checkbox"
								[checked]="isSelected(customer.id)"
								(change)="toggleSelected(customer.id, $any($event.target).checked)"
								class="h-4 w-4 rounded border-neutral-700 bg-neutral-950"
							/>
						</td>

						<td class="px-2 py-3">
							<div class="flex items-center">
								<ng-container *ngIf="customer.avatar; else initialsAvatar">
									<img
										[src]="customer.avatar"
										[alt]="avatarAlt(customer)"
										class="h-9 w-9 rounded-full border border-neutral-800 bg-neutral-950 object-cover"
									/>
								</ng-container>
								<ng-template #initialsAvatar>
									<div
										class="flex h-9 w-9 items-center justify-center rounded-full border border-neutral-800 bg-neutral-950 text-xs font-semibold text-gray-200"
									>
										{{ initials(customer) }}
									</div>
								</ng-template>
							</div>
						</td>

						<td class="px-4 py-3">
							<div class="font-medium text-gray-100">{{ customer.name || '—' }}</div>
						</td>
						<td class="px-4 py-3 text-gray-300">{{ customer.phone || '—' }}</td>
						<td class="px-4 py-3 text-gray-300">{{ customer.email || '—' }}</td>
						<td class="px-4 py-3 text-gray-300">{{ addressLabel(customer) }}</td>
						<td class="px-4 py-3 text-gray-200">{{ customer.totalPayments ?? 0 }}</td>
						<td class="px-4 py-3 text-right">
							<button
								type="button"
								class="inline-flex h-9 w-9 items-center justify-center rounded-xl border border-neutral-800 bg-neutral-950 text-gray-300 transition-colors hover:bg-neutral-900 hover:text-gray-100 focus-visible:ring-2 focus-visible:ring-orange-500 outline-none"
								aria-label="Actions"
							>
								<svg
									viewBox="0 0 24 24"
									fill="none"
									xmlns="http://www.w3.org/2000/svg"
									aria-hidden="true"
									class="h-5 w-5"
								>
									<path
										d="M12 6.5C12.8284 6.5 13.5 5.82843 13.5 5C13.5 4.17157 12.8284 3.5 12 3.5C11.1716 3.5 10.5 4.17157 10.5 5C10.5 5.82843 11.1716 6.5 12 6.5Z"
									fill="currentColor"
									/>
									<path
										d="M12 13.5C12.8284 13.5 13.5 12.8284 13.5 12C13.5 11.1716 12.8284 10.5 12 10.5C11.1716 10.5 10.5 11.1716 10.5 12C10.5 12.8284 11.1716 13.5 12 13.5Z"
									fill="currentColor"
									/>
									<path
										d="M12 20.5C12.8284 20.5 13.5 19.8284 13.5 19C13.5 18.1716 12.8284 17.5 12 17.5C11.1716 17.5 10.5 18.1716 10.5 19C10.5 19.8284 11.1716 20.5 12 20.5Z"
									fill="currentColor"
									/>
								</svg>
							</button>
						</td>
					</tr>

					<tr *ngIf="visibleCustomers.length === 0">
						<td colspan="8" class="px-4 py-10 text-center text-sm text-gray-500">
							No customers found.
						</td>
					</tr>
				</tbody>
			</table>
		</div>

		<div class="flex items-center justify-between gap-3 border-t border-neutral-800 p-4">
			<div class="text-sm text-gray-500">
				Page {{ currentPage }} of {{ totalPages }}
			</div>

			<div class="flex items-center gap-2">
				<button
					type="button"
					(click)="goPrev()"
					[disabled]="currentPage === 1"
					class="inline-flex h-9 w-9 items-center justify-center rounded-xl border border-neutral-800 bg-neutral-950 text-gray-300 disabled:opacity-40"
					aria-label="Previous page"
				>
					&lt;
				</button>

				<ng-container *ngFor="let p of pageButtons">
					<button
						*ngIf="p !== '…'; else dots"
						type="button"
						(click)="goToPage($any(p))"
						class="inline-flex h-9 min-w-9 items-center justify-center rounded-xl border border-neutral-800 px-3 text-sm"
						[ngClass]="
							currentPage === $any(p)
								? 'bg-orange-500/20 text-orange-300'
								: 'bg-neutral-950 text-gray-300'
						"
					>
						{{ p }}
					</button>
					<ng-template #dots>
						<span class="px-2 text-gray-600">…</span>
					</ng-template>
				</ng-container>

				<button
					type="button"
					(click)="goNext()"
					[disabled]="currentPage === totalPages"
					class="inline-flex h-9 w-9 items-center justify-center rounded-xl border border-neutral-800 bg-neutral-950 text-gray-300 disabled:opacity-40"
					aria-label="Next page"
				>
					&gt;
				</button>
			</div>
		</div>
	</div>
</section>
