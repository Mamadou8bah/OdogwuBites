<section class="space-y-4">
    <div class="rounded-2xl border border-white/10 bg-[#222]">
        <div class="flex flex-wrap items-center justify-between gap-3 p-4">
            <div class="flex flex-1 flex-wrap items-center gap-3">
                <div class=" relative w-full max-w-sm">
                    <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center text-gray-500">
                        <svg
							viewBox="0 0 24 24"
							fill="none"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
							class="h-5 w-5"
						>
							<path
								d="M21 21L16.7 16.7"
								stroke="currentColor"
								stroke-width="1.5"
								stroke-linecap="round"
							/>
							<path
								d="M11 18C14.866 18 18 14.866 18 11C18 7.13401 14.866 4 11 4C7.13401 4 4 7.13401 4 11C4 14.866 7.13401 18 11 18Z"
								stroke="currentColor"
								stroke-width="1.5"
							/>
						</svg>
                    </span>
                    <input [(ngModel)]="searchTerm" type="text"
                    placeholder="Search for Benechin, Domoda, Afra..."
                    class="placeholder:text-[14px] w-full rounded-xl border border-white/10 bg-[#292927] py-2.5 pl-10 pr-3 text-sm text-gray-100 placeholder:text-gray-500 outline-none"
                    (input)="onSearchTermChange()">
                </div>
            </div>
            <div class="flex gap-2 justify-center items-center">
                <select
					name="category"
                    class="rounded-xl border border-white/10 bg-[#292927] px-3 py-2 text-sm text-gray-200 outline-none focus-visible:ring-2 focus-visible:ring-orange-500"
					[(ngModel)]="selectedCategory"
					(ngModelChange)="onFilterByCategory()"
				>
                    <option value="all">All Categories</option>
                    <option value="Rice">Rice</option>
                    <option value="Pasta">Pasta</option>
                    <option value="Noodles">Noodles</option>
                    <option value="Swallow">Swallow</option>
                    <option value="Soups">Soups</option>
                    <option value="Sauce">Sauce</option>
                    <option value="Snacks">Snacks</option>
                    <option value="Desserts">Desserts</option>
                    <option value="Drinks">Drinks</option>
                    <option value="Protein">Protein</option>
                    <option value="Seafood">Seafood</option>
                    <option value="Chicken">Chicken</option>
                    <option value="Beef">Beef</option>
                    <option value="Vegetarian">Vegetarian</option>
                    <option value="Breakfast">Breakfast</option>
                    <option value="Combos">Combos</option>
                </select>

								<button
									type="button"
									(click)="addMenuItem()"
									aria-label="Add menu item"
									class="inline-flex h-10 w-10 items-center justify-center rounded-xl bg-orange-500 text-white transition-colors hover:bg-orange-600 focus-visible:ring-2 focus-visible:ring-orange-500 outline-none"
								>
									<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" class="h-5 w-5"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.5"></circle> <path d="M15 12L12 12M12 12L9 12M12 12L12 9M12 12L12 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path> </g></svg>
								</button>

            </div>
        </div>

    <div class="overflow-x-auto">
        <table class="min-w-full table-auto border-collapse">
            <thead class="bg-[#222]">
                <tr>
                    <th class="whitespace-nowrap px-6 py-3 text-left text-sm font-medium text-gray-400">Image</th>
                    <th class="whitespace-nowrap px-6 py-3 text-left text-sm font-medium text-gray-400">Name</th>
                    <th class="whitespace-nowrap px-6 py-3 text-left text-sm font-medium text-gray-400">Price</th>
                    <th class="hidden md:table-cell whitespace-nowrap px-6 py-3 text-left text-sm font-medium text-gray-400">Category</th>
                    <th class="whitespace-nowrap px-6 py-3 text-left text-sm font-medium text-gray-400">Status</th>
                    <th class="whitespace-nowrap px-6 py-3 text-left text-sm font-medium text-gray-400">Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngIf="isLoading">
                    <td colspan="6" class="px-6 py-10 text-center">
                        <div class="mx-auto loader2"></div>
                        <div class="mt-3 text-sm text-gray-400">Loading products…</div>
                    </td>
                </tr>

                <tr *ngIf="!isLoading && loadError">
                    <td colspan="6" class="px-6 py-6 text-center text-sm text-red-300">
                        {{ loadError }}
                    </td>
                </tr>

                <ng-container *ngIf="!isLoading && !loadError">
                    <tr
                        class="border-t border-white/10 hover:bg-white/5 cursor-pointer"
                        *ngFor="let product of getVisibleProducts()"
                        [routerLink]="['/dashboard/products', product._id || product.id]"
                    >
                        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-200">
                            <img src="{{product.imageUrl}}" alt="Product Image" class="h-16 w-16 rounded-full object-cover">
                        </td>
                        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-200">
                            <div class="font-medium">{{product.title}}</div>
                            <div class="mt-1 text-xs text-gray-500 md:hidden">{{product.categoryName}}</div>
                        </td>
                        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-200">${{product.price}}</td>
                        <td class="hidden md:table-cell whitespace-nowrap px-6 py-4 text-sm text-gray-200">{{product.categoryName}}</td>
                        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-200">
                            <p *ngIf="product.isAvailable">Available</p>
                            <p *ngIf="!product.isAvailable">Unavailable</p>
                        </td>
                        <td class="whitespace-nowrap px-6 py-4 text-sm text-gray-200"> 
                            <div class="flex items-center gap-3">
                                <button
                                    type="button"
                                    (click)="$event.stopPropagation(); editProduct(product)"
                                    class="p-2 rounded-lg text-gray-400 hover:text-orange-500 hover:bg-orange-500/10 transition-all duration-300"
                                    aria-label="Edit Product"
                                    [disabled]="isSaving"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>
                                </button>
                                <button
                                    type="button"
                                    (click)="$event.stopPropagation(); deleteProduct(product)"
                                    class="p-2 rounded-lg text-gray-400 hover:text-red-500 hover:bg-red-500/10 transition-all duration-300"
                                    aria-label="Delete Product"
                                    [disabled]="isSaving"
                                >
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
                                </button>
                            </div>
                        </td>
                    </tr>

                    <tr *ngIf="getVisibleProducts().length === 0">
                        <td colspan="6" class="px-6 py-10 text-center text-sm text-gray-500">
                            No products found.
                        </td>
                    </tr>
                </ng-container>
            </tbody>
        </table>
    </div>

    <div>
        <div class="flex items-center justify-between gap-3 border-t border-white/10 p-4">
            <div class="text-sm text-gray-500">
                Page {{ currentPage }} of {{ getTotalPages() }}
            </div>

            <div class="flex items-center gap-2">
                <button
                    type="button"
                    (click)="goPrev()"
                    [disabled]="currentPage === 1"
                    class="inline-flex items-center gap-2 rounded-xl border border-white/10 bg-[#292927] px-4 py-2.5 text-sm text-gray-200 transition-colors hover:bg-[#222] focus-visible:ring-2 focus-visible:ring-orange-500 outline-none disabled:cursor-not-allowed disabled:opacity-50"
                >
                    &lt;
                </button>

                <ng-container *ngFor="let button of getPageButtons()">
                    <button
                        type="button"
                        (click)="goToPage(button)"
                        [disabled]="button === currentPage"
                        class="inline-flex items-center gap-2 rounded-xl border border-white/10 bg-orange-400 px-4 py-2.5 text-sm text-gray-200 transition-colors hover:bg-[#222] focus-visible:ring-2 focus-visible:ring-orange-500 outline-none disabled:cursor-not-allowed disabled:opacity-20"
                    >
                        {{ button }}
                    </button>
                </ng-container>
                <button
                    type="button"
                    (click)="goNext()"
                    [disabled]="currentPage === getTotalPages()"
                    class="inline-flex items-center gap-2 rounded-xl border border-white/10 bg-[#292927] px-4 py-2.5 text-sm text-gray-200 transition-colors hover:bg-[#222] focus-visible:ring-2 focus-visible:ring-orange-500 outline-none disabled:cursor-not-allowed disabled:opacity-50"
                >
                    &gt;
                </button>
            </div>
        </div>
    </div>
    </div>

    <!-- Add Product Modal -->
    <div *ngIf="showAddModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
        <div class="bg-[#222] border border-white/10 w-full max-w-lg rounded-3xl overflow-hidden shadow-2xl">
            <div class="p-6">
                <!-- Logo and Title -->
                <div class="flex flex-col items-center gap-2 mb-8 text-center text-nowrap">
                    <h1 class="logo-text font-bold text-4xl font-lobster text-orange-400">
                        OdogwuBites
                    </h1>
                    <p class="text-gray-400 text-sm">{{ isEditing ? 'Edit Menu Item' : 'Add New Menu Item' }}</p>
                </div>

                <form (ngSubmit)="saveProduct()" #productForm="ngForm" class="space-y-4">
                    <!-- Title -->
                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-1">Product Title</label>
                        <input type="text" name="title" [(ngModel)]="newProduct.title" required
                            placeholder="e.g. Special Chicken Benechin"
                            class="w-full rounded-xl border border-white/10 bg-[#292927] py-2.5 px-4 text-sm text-gray-100 outline-none focus:border-orange-500">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <!-- Price -->
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-1">Price (D)</label>
                            <input type="number" name="price" [(ngModel)]="newProduct.price" required
                                class="w-full rounded-xl border border-white/10 bg-[#292927] py-2.5 px-4 text-sm text-gray-100 outline-none focus:border-orange-500">
                        </div>
                        <!-- Category -->
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-1">Category</label>
                            <select name="categoryName" [(ngModel)]="newProduct.categoryName" required
                                class="w-full rounded-xl border border-white/10 bg-[#292927] py-2.5 px-4 text-sm text-gray-100 outline-none focus:border-orange-500">
                                <option value="" disabled>Select Category</option>
                                <option value="Rice">Rice</option>
                                <option value="Pasta">Pasta</option>
                                <option value="Noodles">Noodles</option>
                                <option value="Swallow">Swallow</option>
                                <option value="Soups">Soups</option>
                                <option value="Sauce">Sauce</option>
                                <option value="Snacks">Snacks</option>
                                <option value="Desserts">Desserts</option>
                                <option value="Drinks">Drinks</option>
                                <option value="Protein">Protein</option>
                                <option value="Seafood">Seafood</option>
                                <option value="Chicken">Chicken</option>
                                <option value="Beef">Beef</option>
                                <option value="Vegetarian">Vegetarian</option>
                                <option value="Breakfast">Breakfast</option>
                                <option value="Combos">Combos</option>
                            </select>
                        </div>
                    </div>

                    <!-- Description -->
                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-1">Description</label>
                        <textarea name="description" [(ngModel)]="newProduct.description" rows="3"
                            placeholder="e.g. Traditional Gambian Jollof Rice served with seasoned chicken and vegetables..."
                            class="w-full rounded-xl border border-white/10 bg-[#292927] py-2.5 px-4 text-sm text-gray-100 outline-none focus:border-orange-500 resize-none"></textarea>
                    </div>

                    <!-- Image Upload -->
                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-1">Upload Image</label>
                        <div class="relative">
                            <input type="file" (change)="onFileSelected($event)" accept="image/*" class="hidden" #fileInput>
                            <button type="button" (click)="fileInput.click()" 
                                class="w-full flex items-center justify-between gap-3 rounded-xl border border-white/10 bg-[#292927] py-2.5 px-4 text-sm text-gray-400 outline-none hover:border-orange-500 transition-all duration-300">
                                <span class="truncate">{{ selectedFileName || 'Choose an image file...' }}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0 text-orange-500"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>
                            </button>
                        </div>
                    </div>

                    <!-- Availability -->
                    <div class="flex items-center gap-3 py-2">
                        <input type="checkbox" name="isAvailable" [(ngModel)]="newProduct.isAvailable" id="isAvailable"
                            class="w-5 h-5 rounded border-white/20 bg-[#292927] text-orange-500 focus:ring-orange-500">
                        <label for="isAvailable" class="text-sm text-gray-300 cursor-pointer">Available for order</label>
                    </div>

                    <!-- Footer Buttons -->
                    <div class="flex gap-3 pt-4">
                        <button type="button" (click)="closeModal()"
                            class="flex-1 px-6 py-3 border border-white/10 text-gray-400 font-bold rounded-2xl hover:bg-white/5 hover:text-white transition-all duration-300">
                            Cancel
                        </button>
                        <button type="submit" [disabled]="!productForm.form.valid || isSaving"
                            class="flex-1 px-6 py-3 bg-orange-500 text-white font-bold rounded-2xl hover:bg-orange-600 transition-all duration-300 disabled:opacity-50 flex items-center justify-center gap-3">
                            <span *ngIf="!isSaving">{{ isEditing ? 'Update Product' : 'Save Product' }}</span>
                            <span *ngIf="isSaving" class="loader4"></span>
                            <span *ngIf="isSaving">Saving…</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>