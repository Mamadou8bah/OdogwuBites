        <section class="space-y-4">

            <div class="flex items-center justify-between">
                <a
                    routerLink="/dashboard/customers"
                    class="inline-flex items-center gap-2 rounded-xl border border-white/10 bg-[#292927] px-4 py-2.5 text-sm text-gray-200 transition-colors hover:bg-[#222] focus-visible:ring-2 focus-visible:ring-orange-500 outline-none"
                >
                    <span>&lt; Back</span>
                </a>
            </div>

            <div *ngIf="isLoading" class="rounded-2xl border border-white/10 bg-[#222] p-8 text-center">
                <div class="mx-auto loader2"></div>
                <div class="mt-3 text-sm text-gray-400">Loading customer…</div>
            </div>
            <div *ngIf="!isLoading && loadError" class="rounded-2xl border border-red-500/30 bg-[#222] p-4 text-sm text-red-300">
                {{ loadError }}
            </div>

            <ng-container *ngIf="!isLoading && !loadError && customer as c">

            <div class="border border-white/10 bg-[#222] p-4 rounded-3xl grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10">
                <div class="flex flex-col items-center gap-4 bg-black/20 p-6 rounded-2xl w-full">
                    <div class="w-40 h-40 sm:w-48 sm:h-48">
                        <ng-container *ngIf="c.avatar; else initialsAvatar">
                            <img [src]="c.avatar" [alt]="c.name || 'Customer avatar'" class="w-full h-full rounded-full object-cover" />
                        </ng-container>
                        <ng-template #initialsAvatar>
                            <div class="w-full h-full rounded-full border border-white/10 bg-orange-400 flex items-center justify-center text-[2.2rem] font-semibold text-gray-200">
                                {{ initials() }}
                            </div>
                        </ng-template>
                    </div>
                    <p class="text-[2.4rem] text-orange-400">{{c.name}}</p>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 w-full gap-6 bg-black/20 p-6 rounded-2xl text-center items-center"> 
                    <div class="bg-[#222] rounded-2xl p-5 flex flex-col gap-2">
                        <p class="text-orange-400">Client</p>
                        <p>{{c.name || '—'}}</p>
                    </div>

                    <div class="bg-[#222] rounded-2xl p-5 flex flex-col gap-2">
                        <p class="text-orange-400">Email</p>
                        <p>{{c.email || '—'}}</p>
                    </div>

                    <div class="bg-[#222] rounded-2xl p-5 flex flex-col gap-2">
                        <p class="text-orange-400">Phone</p>
                        <p>{{c.phone || '—'}}</p>
                    </div>

                    <div class="bg-[#222] rounded-2xl p-5 flex flex-col gap-2">
                        <p class="text-orange-400">Address</p>
                        <p>{{c.address?.street || '—'}}</p>
                    </div>

                    <div class="bg-[#222] rounded-2xl p-5 flex flex-col gap-2">
                        <p class="text-orange-400">Total Payments</p>
                        <p>{{c.totalPayments ?? 0}}</p>
                    </div>

                    <div class="bg-[#222] rounded-2xl p-5 flex flex-col gap-2">
                        <p class="text-orange-400">Total Orders</p>
                        <p>{{c.orderFrequency ?? 0}}</p>
                    </div>
                </div>

                <div class="flex flex-col items-center gap-4 bg-black/20 p-6 rounded-2xl w-full">
                    <p class="text-[2.2rem] text-orange-400">Orders</p>
                    <div class="w-full flex flex-col gap-3">
                        <div *ngFor="let o of pagedOrders" class="w-full rounded-2xl bg-[#222] px-3 py-2 flex flex-col g" >
                            <p class="font-bold text-[0.9rem]">{{o.item}}</p>
                            <div class="flex flex-row justify-between items-center w-full">
                                <div class="text-gray-400 text-[0.7rem]">
                                    <p>{{o.item}}</p>
                                    <p>D{{o.total}}</p>
                                    <p>Wave</p>
                                </div>
                                <div class="flex flex-col text-[0.7rem] justify-between h-full">
                                    <p>{{o.orderDate | date}}</p>
                                    <p [ngClass]="{'text-green-500': o.status === 'delivered', 'text-red-500': o.status !== 'delivered'}">
                                    {{o.status.toUpperCase()}}
                                    </p>
                                </div>
                            </div>
                        </div>

                        <p *ngIf="orders.length === 0" class="text-gray-400 text-[0.9rem] text-center">
                            No orders yet.
                        </p>
                    </div>

                    <div *ngIf="orders.length > 0" class="w-full flex flex-row items-center justify-between mt-3">
                        <button
                            class="bg-[#292927] px-4 py-2 rounded-xl text-[0.85rem] hover:bg-[#222]"
                            (click)="goToPrevOrdersPage()"
                            [disabled]="ordersPage <= 1"
                            [ngClass]="{'opacity-50 cursor-not-allowed': ordersPage <= 1}">
                            Prev
                        </button>

                        <p class="text-gray-400 text-[0.85rem]">
                            Page {{ordersPage}} / {{ordersTotalPages}}
                        </p>

                        <button
                            class="bg-[#292927] px-4 py-2 rounded-xl text-[0.85rem] hover:bg-[#222]"
                            (click)="goToNextOrdersPage()"
                            [disabled]="ordersPage >= ordersTotalPages"
                            [ngClass]="{'opacity-50 cursor-not-allowed': ordersPage >= ordersTotalPages}">
                            Next
                        </button>
                    </div>
                </div>

                <div class="w-full">
                    <div class="w-full bg-black/20 p-4 rounded-2xl text-center">
                        <p class="text-orange-400 text-[2.2rem]">Map</p>
                        <div class="h-64 md:h-92 rounded-xl overflow-hidden border border-white/10">
                            <iframe
                                *ngIf="safeMapUrl"
                                width="100%"
                                height="100%"
                                class="border-0"
                                loading="lazy"
                                [src]="safeMapUrl">
                            </iframe>
                        </div>
                    </div>

                    <div class="mt-4 flex flex-wrap items-center justify-end gap-3">
                        <a
                            routerLink="/dashboard/customers"
                            class="inline-flex items-center gap-2 rounded-xl border border-white/10 bg-[#292927] px-4 py-2.5 text-sm text-gray-200 transition-colors hover:bg-[#222] focus-visible:ring-2 focus-visible:ring-orange-500 outline-none"
                        >
                            Back to Customers
                        </a>

                        <a
                            *ngIf="c.phone"
                            [href]="'tel:' + c.phone"
                            class="inline-flex items-center gap-2 rounded-xl bg-orange-400 px-4 py-2.5 text-sm font-semibold text-black transition-colors hover:bg-orange-300 focus-visible:ring-2 focus-visible:ring-orange-500 outline-none"
                        >
                            Call
                        </a>
                        <span
                            *ngIf="!c.phone"
                            class="inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2.5 text-sm text-gray-400 opacity-60 cursor-not-allowed"
                        >
                            Call
                        </span>

                        <a
                            *ngIf="c.email"
                            [href]="'mailto:' + c.email"
                            class="inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2.5 text-sm text-gray-200 transition-colors hover:bg-white/15 focus-visible:ring-2 focus-visible:ring-orange-500 outline-none"
                        >
                            Email
                        </a>
                        <span
                            *ngIf="!c.email"
                            class="inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2.5 text-sm text-gray-400 opacity-60 cursor-not-allowed"
                        >
                            Email
                        </span>
                    </div>

                </div>
            </div>

            </ng-container>

            <div *ngIf="!isLoading && !loadError && !customer" class="rounded-2xl border border-white/10 bg-[#222] p-4 text-sm text-gray-400">
                Customer not found.
            </div>
        </section>