<section class="min-h-screen bg-[#161812] text-[#e9edc9] flex flex-col overflow-hidden">
  <div class="p-6 border-b border-white/10 max-w-full mx-auto w-full">
    <div class="flex flex-row justify-between items-center">
      <div class="flex items-center gap-4">
        <button class="w-10 h-10 flex items-center justify-center hover:bg-[#222] rounded-xl transition-colors" (click)="closeCart()">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </button>
        <h1 class="text-2xl font-bold tracking-tight">My Cart <span class="text-gray-400 font-normal">({{cartItems.length}})</span></h1>
      </div>
      <!-- Close Button -->
      <button class="w-10 h-10 flex items-center justify-center hover:bg-white/10 rounded-xl transition-all group" (click)="closeCart()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400 group-hover:text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <div class="flex-1 overflow-y-auto p-4 flex flex-col gap-6 max-w-4xl mx-auto w-full">
    <div *ngIf="checkoutSuccess" class="flex flex-col items-center justify-center h-full text-center space-y-4 animate-fadeIn">
      <div class="w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center text-green-500">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
      </div>
      <h2 class="text-2xl font-bold">Order Placed!</h2>
      <p class="text-gray-400">Your delicious meal is on its way.</p>
      <button (click)="checkoutSuccess = false; continueShopping()" class="text-orange-400 font-semibold hover:underline">Continue Browsing</button>
    </div>

    <div *ngIf="!checkoutSuccess && cartItems.length === 0" class="flex flex-col items-center justify-center h-full text-center text-gray-500 py-20">
      <svg class="w-16 h-16 mb-4 opacity-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
      </svg>
      <p class="mb-6">Your cart is empty</p>
      <button (click)="continueShopping()" class="bg-orange-400/10 text-orange-400 px-6 py-2 rounded-xl hover:bg-orange-400 hover:text-[#161812] transition-all font-semibold">
        Continue Shopping
      </button>
    </div>

    <ng-container *ngIf="!checkoutSuccess">
      <div *ngFor="let item of cartItems" class="flex flex-row justify-between items-center bg-[#222]/70 p-3 rounded-2xl border border-white/10">
        
        <div class="flex flex-row items-center gap-4">
          <div class="w-20 h-20 flex-shrink-0">
            <img [src]="item.imageUrl" alt="food image" class="w-full h-full object-cover rounded-xl shadow-md">
          </div>
          
          <div class="flex flex-col gap-2">
            <p class="font-semibold text-[#e9edc9] leading-tight">{{item.name}}</p>
            <div class="flex flex-row items-center bg-[#1a1c15] w-fit rounded-lg p-1">
              <button class="w-6 h-6 flex items-center justify-center hover:bg-[#e86f1c]/30 rounded text-orange-400 font-bold" (click)="decrement(item.id)">-</button>
              <span class="px-3 text-sm font-medium">{{item.quantity}}</span>
              <button class="w-6 h-6 flex items-center justify-center hover:bg-[#e86f1c]/30 rounded text-orange-400 font-bold" (click)="increment(item.id)">+</button>
            </div>
          </div>
        </div>

        <div class="flex flex-col justify-between items-end h-20 py-1">
          <button class="text-red-400 hover:bg-red-400/10 p-1.5 rounded-lg transition-all" (click)="remove(item.id)">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M6 7V18C6 19.1046 6.89543 20 8 20H16C17.1046 20 18 19.1046 18 18V7M6 7H5M6 7H8M18 7H19M18 7H16M10 11V16M14 11V16M8 7V5C8 3.89543 8.89543 3 10 3H14C15.1046 3 16 3.89543 16 5V7M8 7H16" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </button>
          <p class="font-bold text-lg text-orange-400">D{{item.price}}</p>
        </div>
      </div>
    </ng-container>
  </div>

  <div *ngIf="!checkoutSuccess && cartItems.length > 0" class="p-6 bg-[#1a1c15] rounded-t-3xl shadow-[0_-10px_20px_rgba(0,0,0,0.3)] max-w-4xl mx-auto w-full">
    <div class="space-y-3 mb-6">
      <div class="flex justify-between text-gray-400 text-sm">
        <span>Subtotal</span>
        <span>D{{totalPrice}}</span>
      </div>
      <div class="flex justify-between text-gray-400 text-sm">
        <span>Delivery Fee</span>
        <span>D50.00</span>
      </div>
      <div class="flex justify-between text-xl font-bold pt-2 border-t border-white/10">
        <span>Total</span>
        <span class="text-orange-400">D{{totalPrice + 50}}</span>
      </div>
    </div>
    <button (click)="checkout()" [disabled]="isProcessing" class="w-full bg-orange-400 hover:bg-orange-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-[#161812] font-bold py-4 rounded-2xl transition-transform active:scale-[0.98] flex items-center justify-center gap-3">
      <svg *ngIf="isProcessing" class="animate-spin h-5 w-5 text-[#161812]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      {{ isProcessing ? 'Redirecting...' : 'Proceed to Checkout' }}
    </button>
  </div>
</section>