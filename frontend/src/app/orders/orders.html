<section class="space-y-4">
	<div class="rounded-2xl border border-white/10 bg-[#222]">
		<div class="flex flex-wrap items-center justify-between gap-3 p-4">
			<div class="flex flex-1 flex-wrap items-center gap-3">
				<div class="relative w-full max-w-sm">
					<span class="pointer-events-none absolute inset-y-0 left-3 flex items-center text-gray-500">
						<svg
							viewBox="0 0 24 24"
							fill="none"
							xmlns="http://www.w3.org/2000/svg"
							aria-hidden="true"
							class="h-5 w-5"
						>
							<path
								d="M21 21L16.7 16.7"
								stroke="currentColor"
								stroke-width="1.5"
								stroke-linecap="round"
							/>
							<path
								d="M11 18C14.866 18 18 14.866 18 11C18 7.13401 14.866 4 11 4C7.13401 4 4 7.13401 4 11C4 14.866 7.13401 18 11 18Z"
								stroke="currentColor"
								stroke-width="1.5"
							/>
						</svg>
					</span>
					<input
						type="search"
						placeholder="Search"
						[(ngModel)]="searchTerm"
						(ngModelChange)="onSearchTermChange()"
						class="w-full rounded-xl border border-white/10 bg-[#292927] py-2.5 pl-10 pr-3 text-sm text-gray-100 placeholder:text-gray-500 outline-none focus-visible:ring-2 focus-visible:ring-orange-500"
					/>
				</div>
			</div>

			<div class="flex items-center gap-2 text-sm text-gray-400">
				<span>Sort by :</span>
				<select
					[(ngModel)]="sortOrder"
					(ngModelChange)="onSortOrderChange()"
					aria-label="Sort orders"
					class="rounded-xl border border-white/10 bg-[#292927] px-3 py-2 text-sm text-gray-200 outline-none focus-visible:ring-2 focus-visible:ring-orange-500"
				>
					<option value="newest">newest</option>
					<option value="oldest">oldest</option>
				</select>
			</div>
		</div>

		<div class="overflow-x-auto">
			<table class="min-w-full border-separate border-spacing-0 text-left text-sm">
				<thead>
					<tr class="text-xs text-gray-400">
					
						<th class="px-4 py-3">Order no</th>
						<th class="hidden md:table-cell px-4 py-3">Item</th>
						<th class="hidden lg:table-cell px-4 py-3">Delivery name</th>
						<th class="hidden md:table-cell px-4 py-3">Date</th>
						<th class="hidden lg:table-cell px-4 py-3">Time</th>
						<th class="hidden xl:table-cell px-4 py-3">Location</th>
						<th class="px-4 py-3">Status</th>
						<th class="px-4 py-3 text-right">Actions</th>
					</tr>
				</thead>

				<tbody>
					<tr *ngIf="loading">
						<td colspan="8" class="px-4 py-10 text-center">
							<div class="mx-auto loader2"></div>
							<div class="mt-3 text-sm text-gray-400">Loading orders…</div>
						</td>
					</tr>

					<ng-container *ngIf="!loading">
					<tr
						*ngFor="let order of visibleOrders; trackBy: trackByOrderId"
						[routerLink]="[order.orderId]"
						class="border-t border-white/10 text-gray-100 cursor-pointer"
					>
						

						<td class="px-4 py-3 text-gray-200">
							<div class="font-medium">{{ order.orderId }}</div>
							<div class="mt-1 space-y-0.5 text-xs text-gray-500 md:hidden">
								<div class="flex flex-wrap gap-x-2 gap-y-0.5">
									<span>{{ restaurantLabel(order) }}</span>
									<span class="text-gray-600">•</span>
									<span>{{ dateLabel(order) }}</span>
									<span class="text-gray-600">•</span>
									<span>{{ locationLabel(order) }}</span>
								</div>
							</div>
						</td>
						<td class="hidden md:table-cell px-4 py-3 text-gray-300">{{ restaurantLabel(order) }}</td>
						<td class="hidden lg:table-cell px-4 py-3 text-gray-300">{{ deliveryName(order) }}</td>
						<td class="hidden md:table-cell px-4 py-3 text-gray-300">{{ dateLabel(order) }}</td>
						<td class="hidden lg:table-cell px-4 py-3 text-gray-300">{{ timeLabel(order) }}</td>
						<td class="hidden xl:table-cell px-4 py-3 text-gray-300">{{ locationLabel(order) }}</td>
						<td class="px-4 py-3">
							<span
								[ngClass]="
									(order.status ?? '').toLowerCase() === 'delivered'
										? 'text-green-400'
										: (order.status ?? '').toLowerCase() === 'canceled' ||
												(order.status ?? '').toLowerCase() === 'cancelled'
											? 'text-red-400'
											: 'text-orange-300'
								"
								class="font-medium"
							>
								{{ statusLabel(order) }}
							</span>
						</td>
						<td class="px-4 py-3 text-right">
							<div class="relative inline-block" (click)="$event.stopPropagation()">
								<button
									type="button"
									(click)="toggleActions(order.orderId)"
									class="inline-flex h-9 w-9 items-center justify-center rounded-xl text-gray-300 transition-colors hover:text-gray-100 focus-visible:ring-2 focus-visible:ring-orange-500 outline-none"
									aria-label="Actions"
								>
									<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" class="h-5 w-5"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M18 12H18.01M12 12H12.01M6 12H6.01M13 12C13 12.5523 12.5523 13 12 13C11.4477 13 11 12.5523 11 12C11 11.4477 11.4477 11 12 11C12.5523 11 13 11.4477 13 12ZM19 12C19 12.5523 18.5523 13 18 13C17.4477 13 17 12.5523 17 12C17 11.4477 17.4477 11 18 11C18.5523 11 19 11.4477 19 12ZM7 12C7 12.5523 6.55228 13 6 13C5.44772 13 5 12.5523 5 12C5 11.4477 5.44772 11 6 11C6.55228 11 7 11.4477 7 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
								</button>

								<div
									*ngIf="openActionsForOrderId === order.orderId"
									class="absolute right-0 z-20 mt-2 w-44 overflow-hidden rounded-xl border border-white/10 bg-[#292927] shadow-lg"
									role="menu"
								>
									<button
										type="button"
										(click)="markCompleted(order)"
										[disabled]="!canMarkCompleted(order)"
										class="block w-full px-4 py-2.5 text-left text-sm text-gray-200 hover:bg-[#222] disabled:opacity-40"
										role="menuitem"
									>
										Mark as completed
									</button>
									<button
										type="button"
										(click)="cancelOrder(order)"
										[disabled]="!canCancel(order)"
										class="block w-full px-4 py-2.5 text-left text-sm text-red-300 hover:bg-[#222] disabled:opacity-40"
										role="menuitem"
									>
										Cancel order
									</button>
									<button
										type="button"
										(click)="closeActions()"
										class="block w-full px-4 py-2.5 text-left text-sm text-gray-400 hover:bg-[#222]"
										role="menuitem"
									>
										Close
									</button>
								</div>
							</div>
						</td>
					</tr>

					<tr *ngIf="visibleOrders.length === 0">
						<td colspan="8" class="px-4 py-10 text-center text-sm text-gray-500">
							No orders found.
						</td>
					</tr>
					</ng-container>
				</tbody>
			</table>
		</div>

		<div class="flex items-center justify-between gap-3 border-t border-white/10 p-4">
			<div class="text-sm text-gray-500">Page {{ currentPage }} of {{ totalPages }}</div>

			<div class="flex items-center gap-2">
				<button
					type="button"
					(click)="goPrev()"
					[disabled]="currentPage === 1"
					class="inline-flex h-9 w-9 items-center justify-center rounded-xl border border-white/10 bg-[#292927] text-gray-300 disabled:opacity-40"
					aria-label="Previous page"
				>
					&lt;
				</button>

				<ng-container *ngFor="let p of pageButtons">
					<button
						*ngIf="p !== '…'; else dots"
						type="button"
						(click)="goToPage($any(p))"
						class="inline-flex h-9 min-w-9 items-center justify-center rounded-xl border border-white/10 px-3 text-sm"
						[ngClass]="
							currentPage === $any(p)
								? 'bg-orange-500/20 text-orange-300'
								: 'bg-[#292927] text-gray-300'
						"
					>
						{{ p }}
					</button>
					<ng-template #dots>
						<span class="px-2 text-gray-600">…</span>
					</ng-template>
				</ng-container>

				<button
					type="button"
					(click)="goNext()"
					[disabled]="currentPage === totalPages"
					class="inline-flex h-9 w-9 items-center justify-center rounded-xl border border-white/10 bg-[#292927] text-gray-300 disabled:opacity-40"
					aria-label="Next page"
				>
					&gt;
				</button>
			</div>
		</div>
	</div>
</section>
